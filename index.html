<!DOCTYPE html>
<html>
<head>
  <title>LDR Status</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    .sensor { margin: 10px 0; font-size: 18px; }
    .high { color: green; }
    .low { color: red; }
  </style>
</head>
<body>
  <h2>LDR Status</h2>
  <div id="output">Loading...</div>

  <script>
    const apiUrl = "https://api.thingspeak.com/channels/3025601/feeds/last.json?api_key=TRTP21O7HR219MPB";
    const threshold = 500;

    function updateData() {
      fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
          let html = "";
          for (let i = 1; i <= 4; i++) {
            const value = parseInt(data["field" + i]);
            const status = value >= threshold ? "HIGH" : "LOW";
            const cssClass = value >= threshold ? "high" : "low";
            html += `<div class="sensor">LDR ${i}: <span class="${cssClass}">${status}</span></div>`;
          }
          document.getElementById("output").innerHTML = html;
        })
        .catch(error => {
          document.getElementById("output").textContent = "Error fetching data.";
          console.error("ThingSpeak error:", error);
        });
    }

    updateData(); // Run once on page load
    setInterval(updateData, 15000); // Then every 15 seconds
  </script>
</body>
</html>
